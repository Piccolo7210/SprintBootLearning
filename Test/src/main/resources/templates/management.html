<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Management System - CRUD Operations</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .section-header {
            background-color: #f8f9fa;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        .form-container {
            background-color: #e9ecef;
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 8px;
        }
        .table-container {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #dee2e6;
            border-radius: 8px;
        }
        .btn-sm { margin: 0 2px; }
        .loading { display: none; }
        .error { color: #dc3545; margin-top: 10px; }
        .success { color: #28a745; margin-top: 10px; }
    </style>
</head>
<body>
    <div class="container-fluid mt-3">
        <h1 class="text-center mb-4">
            <i class="fas fa-cogs"></i> Management System - CRUD Operations
        </h1>

        <!-- Students Section -->
        <div class="section-header">
            <h2><i class="fas fa-user-graduate"></i> Students Management</h2>
        </div>

        <!-- Student Create Form -->
        <div class="form-container">
            <h5>Add New Student</h5>
            <form id="studentForm">
                <div class="row g-2">
                    <div class="col-md-2">
                        <input type="text" id="studentName" class="form-control" placeholder="Name" required>
                    </div>
                    <div class="col-md-1">
                        <input type="number" id="studentAge" class="form-control" placeholder="Age" required>
                    </div>
                    <div class="col-md-2">
                        <input type="email" id="studentEmail" class="form-control" placeholder="Email" required>
                    </div>
                    <div class="col-md-2">
                        <input type="number" step="0.01" id="studentCgpa" class="form-control" placeholder="CGPA">
                    </div>
                    <div class="col-md-2">
                        <input type="number" id="studentDeptId" class="form-control" placeholder="Dept ID">
                    </div>
                    <div class="col-md-2">
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-plus"></i> Add Student
                        </button>
                    </div>
                </div>
                <div id="studentMessage"></div>
            </form>
        </div>

        <!-- Students Table -->
        <div class="table-container">
            <div class="d-flex justify-content-between mb-2 p-2">
                <button id="loadStudents" class="btn btn-primary">
                    <i class="fas fa-sync-alt"></i> Load Students
                </button>
                <div class="loading" id="studentsLoading">
                    <i class="fas fa-spinner fa-spin"></i> Loading...
                </div>
            </div>
            <div id="students-table">
                <p class="text-muted p-3">Click "Load Students" to view all students</p>
            </div>
        </div>

        <!-- Courses Section -->
        <div class="section-header mt-5">
            <h2><i class="fas fa-book"></i> Courses Management</h2>
        </div>

        <!-- Course Create Form -->
        <div class="form-container">
            <h5>Add New Course</h5>
            <form id="courseForm">
                <div class="row g-2">
                    <div class="col-md-3">
                        <input type="text" id="courseName" class="form-control" placeholder="Course Name" required>
                    </div>
                    <div class="col-md-2">
                        <input type="number" id="courseCredits" class="form-control" placeholder="Credits" required>
                    </div>
                    <div class="col-md-2">
                        <input type="number" id="courseDeptId" class="form-control" placeholder="Dept ID">
                    </div>
                    <div class="col-md-2">
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-plus"></i> Add Course
                        </button>
                    </div>
                </div>
                <div id="courseMessage"></div>
            </form>
        </div>

        <!-- Courses Table -->
        <div class="table-container">
            <div class="d-flex justify-content-between mb-2 p-2">
                <button id="loadCourses" class="btn btn-primary">
                    <i class="fas fa-sync-alt"></i> Load Courses
                </button>
                <div class="loading" id="coursesLoading">
                    <i class="fas fa-spinner fa-spin"></i> Loading...
                </div>
            </div>
            <div id="courses-table">
                <p class="text-muted p-3">Click "Load Courses" to view all courses</p>
            </div>
        </div>

        <!-- Departments Section -->
        <div class="section-header mt-5">
            <h2><i class="fas fa-building"></i> Departments Management</h2>
        </div>

        <!-- Department Create Form -->
        <div class="form-container">
            <h5>Add New Department</h5>
            <form id="departmentForm">
                <div class="row g-2">
                    <div class="col-md-3">
                        <input type="text" id="departmentName" class="form-control" placeholder="Department Name" required>
                    </div>
                    <div class="col-md-4">
                        <input type="text" id="departmentDescription" class="form-control" placeholder="Description">
                    </div>
                    <div class="col-md-2">
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-plus"></i> Add Department
                        </button>
                    </div>
                </div>
                <div id="departmentMessage"></div>
            </form>
        </div>

        <!-- Departments Table -->
        <div class="table-container">
            <div class="d-flex justify-content-between mb-2 p-2">
                <button id="loadDepartments" class="btn btn-primary">
                    <i class="fas fa-sync-alt"></i> Load Departments
                </button>
                <div class="loading" id="departmentsLoading">
                    <i class="fas fa-spinner fa-spin"></i> Loading...
                </div>
            </div>
            <div id="departments-table">
                <p class="text-muted p-3">Click "Load Departments" to view all departments</p>
            </div>
        </div>

        <!-- Student Enrollments Section -->
        <div class="section-header mt-5">
            <h2><i class="fas fa-user-check"></i> Student Course Enrollments</h2>
        </div>

        <!-- Enrollment Form -->
        <div class="form-container">
            <h5>Enroll Student in Course</h5>
            <form id="enrollmentForm">
                <div class="row g-2">
                    <div class="col-md-2">
                        <input type="number" id="enrollStudentId" class="form-control" placeholder="Student ID" required>
                    </div>
                    <div class="col-md-2">
                        <input type="number" id="enrollCourseId" class="form-control" placeholder="Course ID" required>
                    </div>
                    <div class="col-md-2">
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-user-plus"></i> Enroll Student
                        </button>
                    </div>
                </div>
                <div id="enrollmentMessage"></div>
            </form>
        </div>

        <!-- Enrollments Table -->
        <div class="table-container">
            <div class="d-flex justify-content-between mb-2 p-2">
                <div>
                    <button id="loadEnrollments" class="btn btn-primary me-2">
                        <i class="fas fa-sync-alt"></i> Load All Enrollments
                    </button>
                    <button id="loadGroupedEnrollments" class="btn btn-info">
                        <i class="fas fa-users"></i> Load Grouped by Students
                    </button>
                </div>
                <div class="loading" id="enrollmentsLoading">
                    <i class="fas fa-spinner fa-spin"></i> Loading...
                </div>
            </div>
            <div id="enrollments-table">
                <p class="text-muted p-3">Click "Load All Enrollments" to view all student course enrollments or "Load Grouped by Students" to see enrollments organized by student names</p>
            </div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editModalLabel">Edit Record</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editForm">
                        <div id="editFormFields"></div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" id="saveEdit" class="btn btn-success">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/management.js"></script>
</body>
</html>
